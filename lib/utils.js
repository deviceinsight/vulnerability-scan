const { getBorderCharacters } = require('table');

const dataTableConfig = {
	border: getBorderCharacters(`norc`),
	columns: {
		0: { width: 15 },
		1: { width: 55 }
	}
};

const errorTableConfig = {
	border: getBorderCharacters(`void`),
	columnDefault: {
		width: 70,
		paddingLeft: 0,
		paddingRight: 1
	},
	drawHorizontalLine: () => {
		return false;
	}
};

const mapSeverityToColor = severity => {
	switch (severity) {
		case 'critical':
			return 'magenta';
		case 'high':
			return 'red';
		case 'moderate':
			return 'yellow';
		case 'low':
		default:
			return 'white';
	}
};

const parseJson = string => {
	try {
		return JSON.parse(string);
	} catch (e) {
		return false;
	}
};

module.exports = {
	dataTableConfig,
	errorTableConfig,
	mapSeverityToColor,
	parseJson
};
